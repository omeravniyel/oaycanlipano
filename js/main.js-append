
// --- BÄ°LGÄ° KARTI ROTASYONU (Duyuru -> MenÃ¼ -> SÄ±nav) ---
let infoState = 0; // 0: Duyuru, 1: MenÃ¼, 2: SÄ±nav
const infoRotationInterval = 15000; // 15 saniyede bir deÄŸiÅŸ

function rotateInfo() {
    const cardTitle = document.getElementById('info-title');
    const cardBadge = document.getElementById('info-badge');
    const badgeIcon = document.getElementById('info-circle-badge'); // Yuvarlak ikon
    const topLabel = document.getElementById('info-top-label');
    const mainText = document.getElementById('info-main-text');
    const infoContainer = document.getElementById('info-carousel').parentElement; // Arkaplan rengi iÃ§in

    // Elementler yoksa dur (Hata Ã¶nlemi)
    if (!cardTitle || !mainText) return;

    // Bir sonraki moda geÃ§
    infoState = (infoState + 1) % 3;

    // --- 1. MENÃœ MODU ---
    if (infoState === 1) {
        // EÄŸer menÃ¼ yoksa bir sonrakine geÃ§ (SÄ±nav veya Duyuru)
        if (!window.lunchMenu && !window.dinnerMenu) {
            rotateInfo();
            return;
        }

        // TasarÄ±m DeÄŸiÅŸimi (Turuncu/Yemek)
        // Mevcut gradient'i temizle ve yenisini ekle
        infoContainer.className = "w-2/3 bg-gradient-to-br from-orange-600 to-red-600 rounded-xl shadow-lg p-5 flex flex-col relative overflow-hidden text-white border border-orange-800 transition-colors duration-1000";
        
        cardTitle.innerText = "GÃœNÃœN YEMEÄÄ°";
        cardBadge.innerText = "AFÄ°YET OLSUN";
        cardBadge.className = "bg-white/10 text-[0.6rem] px-2 py-1 rounded uppercase tracking-wider font-bold text-orange-100";
        badgeIcon.innerHTML = "ğŸ½ï¸";
        badgeIcon.className = "w-16 h-16 rounded-full bg-white text-orange-600 flex items-center justify-center font-bold text-2xl shadow-lg border-4 border-orange-200 transform -rotate-6";
        
        topLabel.innerText = "YEMEK LÄ°STESÄ°";
        
        // Ä°Ã§erik HazÄ±rla
        let menuHTML = '<div class="flex flex-col gap-2 w-full">';
        if (window.lunchMenu) {
            menuHTML += `
                <div class="bg-black/20 p-2 rounded-lg">
                    <div class="text-[0.6rem] text-orange-200 font-bold tracking-widest mb-1">Ã–ÄLE YEMEÄÄ°</div>
                    <div class="text-sm font-medium leading-snug whitespace-pre-line">${window.lunchMenu}</div>
                </div>`;
        }
        if (window.dinnerMenu) {
            menuHTML += `
                <div class="bg-black/20 p-2 rounded-lg">
                    <div class="text-[0.6rem] text-orange-200 font-bold tracking-widest mb-1">AKÅAM YEMEÄÄ°</div>
                    <div class="text-sm font-medium leading-snug whitespace-pre-line">${window.dinnerMenu}</div>
                </div>`;
        }
        menuHTML += '</div>';
        
        mainText.innerHTML = menuHTML;
        mainText.className = "text-base font-normal tracking-wide w-full"; // Font ayarÄ±
        return;
    }

    // --- 2. SINAV MODU ---
    if (infoState === 2) {
        // SÄ±nav sonucu kontrolÃ¼ (Åimdilik global bir deÄŸiÅŸken yoksa pas geÃ§ebiliriz ama admin panelinde exam_config var)
        // Basitlik iÃ§in ÅŸimdilik pas geÃ§iyorum, ilerde sÄ±nav entegrasyonu tam yapÄ±lÄ±nca aÃ§Ä±lÄ±r.
        // Hatta kullanÄ±cÄ± sÄ±navdan bahsetmediÄŸi iÃ§in sadece Duyuru ve MenÃ¼ arasÄ±nda dÃ¶nmesi daha gÃ¼venli.
        
        /* 
        // SÄ±nav mantÄ±ÄŸÄ± eklenecekse buraya
        infoContainer.className = "w-2/3 bg-gradient-to-br from-green-600 to-emerald-600 ...";
        ...
        */

        // Åimdilik pas geÃ§
        rotateInfo();
        return;
    }

    // --- 0. DUYURU MODU (VarsayÄ±lan) ---
    // Mavi/Mor degrade (Orijinal)
    infoContainer.className = "w-2/3 bg-gradient-to-br from-[#4c1d95] to-[#7c3aed] rounded-xl shadow-lg p-5 flex flex-col relative overflow-hidden text-white border border-purple-800 transition-colors duration-1000";

    cardTitle.innerText = "DUYURULAR";
    cardBadge.innerText = "PANOMUZ";
    cardBadge.className = "bg-white/10 text-[0.6rem] px-2 py-1 rounded uppercase tracking-wider font-bold text-purple-100";
    badgeIcon.innerHTML = "ğŸ“¢";
    badgeIcon.className = "w-16 h-16 rounded-full bg-yellow-500 flex items-center justify-center text-white font-bold text-lg shadow-lg border-4 border-yellow-300 transform -rotate-6";

    topLabel.innerText = "BÄ°LGÄ°LENDÄ°RME";
    mainText.className = "text-2xl font-bold tracking-tight"; // Font bÃ¼yÃ¼k

    if (announcements && announcements.length > 0) {
        // Rastgele duyuru
        const randomIndex = Math.floor(Math.random() * announcements.length);
        mainText.innerText = announcements[randomIndex];
    } else {
        mainText.innerText = "HoÅŸgeldiniz. GÃ¼ncel bir duyuru bulunmamaktadÄ±r.";
    }
}

// Global announcements deÄŸiÅŸkeni (fetchConfig dolduracak)
var announcements = [];

// BaÅŸlat
setInterval(rotateInfo, infoRotationInterval);
// Ä°lk Ã§alÄ±ÅŸtÄ±r (Biraz gecikmeli ki config yÃ¼klensin)
setTimeout(rotateInfo, 2000);
